# Custom values for the Trino Helm chart
# Values placed under the 'trino:' key will be passed to the subchart.
trino:
  additionalConfigProperties:
  - http-server.process-forwarded=true
  - internal-communication.shared-secret=dug5cTAEayZB6S6R+OghCfQBUXcE4pDrNe0Z6I4cqMEWDjn7xQFJrLq2xB8GBlvMp9FAL7E894wGCymJreMBaCUbH1VuWUf+HXTFG/gtgqhWRISR4d6ZK9mRoOlAjVQYkpg0P94phqfkRyCSAcx6Zvz+k3eRdTnh2059IRdTrOyT9VFuiU7WOWt21/dgnKgjmexKFPzxcY5Pxg6/e2J7k0Pk6R+gNALaCeRYNt/eMG7w/+EYnwtCTdiAJuvZcCQrk7qZzAj0NGLPr4VSEy+SI/vHQct5sYHTwLFeupe3kkWNPwKmDKxVIssJnoOznNCyFEMAGAwHdl4AuHR4ZosxckE4Pgn/PktCPOAi4fJVAzhsnoZcftDDR4OXG1LHIUZ50jZtpiDBSWY/pzDhgPUgDC5n6a4LWi4Z76qYVfxDg+irc1DSY9YphXCHOb0telJUvzrjp9+TMCq9DZsL+IT3EZCIBn8tClVtf7lfN4VEFgVYjQTV7VwSohY3aY3SyJr1k/PQkhSgUQ1kW+YfI/vsrWqkuchNCmqjt1N3ewdyNsRgeGoOT7nFUgDoNv5umlvM3bwdHKT/4RQpe7z+6N7xyaojMzq4PK0sCVj1wpkKuiRy35LxU5O6ulfWUI5REdzJE2ODn/qOmYRnnyM55m8vOpYgb9vg1ZlFNUymP/bojqY=
  server:
    workers: 1
    config:
      authenticationType: "PASSWORD"
  coordinator:
    annotations:
      node.kubernetes.io/instance-type: "CX52"
    resources:
      requests:
        cpu: 500m
        memory: 2Gi
      limits:
        cpu: 2000m
        memory: 4Gi
  worker:
    annotations:
      node.kubernetes.io/instance-type: "CX52"
    resources:
      requests:
        cpu: 500m
        memory: 4Gi
      limits:
        cpu: 2000m
        memory: 8Gi
  envFrom:
  - secretRef:
      name: s3-credentials
    prefix: S3_
  - secretRef:
      name: pg-credentials
    prefix: PG_
  catalogs:
    iceberg: |
      connector.name=iceberg
      iceberg.catalog.type=jdbc
      iceberg.jdbc-catalog.catalog-name=catalog
      iceberg.jdbc-catalog.driver-class=org.postgresql.Driver
      iceberg.jdbc-catalog.connection-url=jdbc:postgresql://${ENV:PG_HOST}:${ENV:PG_PORT}/catalog
      iceberg.jdbc-catalog.connection-user=${ENV:PG_USERNAME}
      iceberg.jdbc-catalog.connection-password=${ENV:PG_PASSWORD}
      iceberg.jdbc-catalog.default-warehouse-dir=s3://dp-stack-tf-os
      fs.native-s3.enabled=true
      s3.endpoint=${ENV:S3_ENDPOINT}
      s3.region=${ENV:S3_REGION}
      s3.aws-access-key=${ENV:S3_ACCESS_KEY_ID}
      s3.aws-secret-key=${ENV:S3_SECRET_ACCESS_KEY}
  auth:
    passwordAuth: "admin:$2b$08$mJ4nVo8R63bcmJlBNxOsreqLaQF3ajVGAgvHZ28QAOOJ23VFgYTxG"

  # Configure ingress for Trino
  ingress:
    enabled: true
    annotations:
      # Use Traefik's websecure entrypoint for HTTPS
      traefik.ingress.kubernetes.io/router.entrypoints: websecure
      # Enable TLS termination at the router (Traefik handles certs)
      traefik.ingress.kubernetes.io/router.tls: "true"
    hosts:
    - host: trino.cloudfleet.platform.5ha.re
      paths:
      - path: /
        pathType: Prefix
